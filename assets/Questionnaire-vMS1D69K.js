import{r as w,v as xe,z as Ce,j as e,T as I,B as y,W as V,o as O,P as Z,X as J,n as he,m as me,Y as Fe,x as Te,Z as we,S as qe,$ as $e,a0 as ee,a1 as U,p as de,a2 as Ae,A as Ee}from"./index-DQ6dPsCc.js";import{r as Re,C as Le}from"./createSvgIcon-BZbvq0S8.js";import{F as R,a as L,T as ue}from"./TextField-CSm90r8d.js";import{R as G,a as _}from"./RadioGroup-ovdB22VD.js";import{F as E}from"./FormControlLabel-DLpYiiV4.js";import{T as se,a as te,b as ne,c as N,d as b,e as re}from"./TableRow-DtqDv4Ut.js";import{C as pe}from"./Container-E4VSzprl.js";import"./SwitchBase-D9Gsecah.js";const _e=()=>{const[F,o]=w.useState(null),[a,r]=w.useState(!1),[g,m]=w.useState(null);return{createForm:async c=>{r(!0),m(null),o(null);try{const u=await xe.post("undefinedform",{form_data:c},{headers:{Authorization:`${localStorage.getItem("token")}`,"Content-Type":"application/json"}});return o(u.data),u.data}catch(u){m(u.response?u.response.status:u.message)}finally{r(!1)}},response:F,loading:a,error:g}},Oe=()=>{const[F,o]=w.useState(null),[a,r]=w.useState(!1),[g,m]=w.useState(null);return{FinishForm:async c=>{r(!0),m(null),o(null);try{const u=await xe.post("undefinedform/finish",{form_data:c},{headers:{Authorization:`${localStorage.getItem("token")}`,"Content-Type":"application/json"}});return o(u.data),u.data}catch(u){m(u.response?u.response.status:u.message)}finally{r(!1)}},response:F,loading:a,error:g}};var oe={},Be=Ce;Object.defineProperty(oe,"__esModule",{value:!0});var fe=oe.default=void 0,Ie=Be(Re()),Me=e;fe=oe.default=(0,Ie.default)((0,Me.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");const K={"& .MuiRadio-root":{color:"white"},"& .MuiRadio-root.Mui-checked":{color:"white"},"& .MuiRadio-root .MuiSvgIcon-root":{backgroundColor:"white",borderRadius:"50%"}},Ne={"& .MuiCheckbox-root":{color:"white"},"& .MuiCheckbox-root.Mui-checked":{color:"white"},"& .MuiCheckbox-root .MuiSvgIcon-root":{backgroundColor:"white"}},ge=(F,o,a,r)=>{const g=m=>!r[m]&&r.hasOwnProperty(m);switch(F){case"H2":return e.jsx(I,{variant:"h2",children:o});case"Text":return Array.isArray(o)?o.map((s,n)=>e.jsx(I,{variant:"body1",children:J(s)},n)):e.jsx(I,{variant:"body1",children:J(o)});case"radio":const[m,...v]=o;return e.jsxs(R,{component:"fieldset",children:[e.jsx(L,{component:"legend",children:m}),e.jsx(G,{name:m,onChange:a,value:r[m]||"",children:v.map((s,n)=>e.jsx(E,{value:n.toString(),control:e.jsx(_,{sx:{...K,...g(m)?{border:"2px solid red"}:{}}}),label:s},n))})]});case"checkbox":const[c,...u]=o;return e.jsxs(R,{component:"fieldset",children:[e.jsx(L,{component:"legend",children:c}),u.map((s,n)=>e.jsx(E,{control:e.jsx(Le,{sx:{...Ne,...g(c)?{border:"2px solid red"}:{}},name:c,value:s,checked:(r[c]||[]).includes(s),onChange:a}),label:s},n))]});case"checkboxKey":const[B,...q]=o;return e.jsxs(R,{component:"fieldset",children:[e.jsx(L,{component:"legend",children:B}),q.map((s,n)=>e.jsxs(y,{sx:{mb:2},children:[e.jsx(I,{variant:"body1",children:s.label}),e.jsx(G,{name:`${B}_${s.label}`,onChange:a,value:r[`${B}_${s.label}`]||"",children:s.options.map((p,i)=>e.jsx(E,{value:i.toString(),control:e.jsx(_,{sx:K}),label:p},i))})]},n))]});case"input":return e.jsxs(R,{children:[e.jsx(L,{component:"legend",children:o}),e.jsx("input",{variant:"outlined",sx:{bgcolor:"white",...g(o)?{border:"2px solid red"}:{}},name:o,value:r[o]||"",onChange:a,label:o})]});case"inputKey":return e.jsx(R,{children:o.map((s,n)=>e.jsxs(y,{sx:{mb:2,height:"44px"},children:[e.jsx(L,{children:s.label}),e.jsx(ue,{variant:"outlined",sx:{bgcolor:"white",height:"41px",...g(s.label)?{border:"2px solid red"}:{}},name:s.label,value:r[s.label]||"",onChange:a})]},n))});case"ladderRadio":{const[s,n]=o;return e.jsxs(R,{className:"not-required",component:"fieldset",sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(L,{component:"legend",sx:{mb:2,textAlign:"left"},children:s}),e.jsxs(y,{sx:{display:"flex",alignItems:"flex-start"},children:[e.jsx(y,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",mr:2},children:n.map((p,i)=>e.jsx(I,{sx:{height:"40px",display:"flex",alignItems:"center"},children:n.length-1-i},i))}),e.jsx(G,{name:s,onChange:a,value:r[s]||"",sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"435px"},children:n.map((p,i)=>e.jsx(E,{value:(n.length-1-i).toString(),control:e.jsx(_,{sx:{...K,...g(s)?{border:"2px solid red"}:{}}}),label:"",sx:{display:"flex",justifyContent:"center",height:"38px"}},i))}),e.jsx(y,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",ml:2,height:"435px",justifyContent:"space-between"},children:n.map((p,i)=>e.jsx(I,{sx:{height:"36px",display:"flex",alignItems:"center"},children:p},i))})]})]})}case"recreationalActivityTable":{const{activities:s,weightTrainingActivities:n,timeRanges:p}=o,i=()=>{s.forEach(t=>{a({target:{name:t,value:"2"}})}),n.forEach(t=>{a({target:{name:t,value:"2"}})})};return e.jsxs(y,{children:[e.jsx(O,{variant:"contained",onClick:i,sx:{mb:2},children:"Check All"}),e.jsx(se,{component:Z,children:e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(N,{children:[e.jsx(b,{children:"Activity"}),p.map((t,f)=>e.jsx(b,{children:t},f))]})}),e.jsxs(re,{className:"radio-table",children:[s.map((t,f)=>e.jsxs(N,{children:[e.jsx(b,{children:t}),p.map((S,h)=>e.jsx(b,{children:e.jsx(E,{control:e.jsx(_,{name:t,value:h.toString(),checked:r[t]===h.toString(),onChange:T=>a({target:{name:t,value:T.target.value}})})})},h))]},f)),e.jsx(N,{children:e.jsx(b,{colSpan:11,children:e.jsx(I,{variant:"h6",children:"Weight training or resistance exercises (e.g., free weights or machines)"})})}),n.map((t,f)=>e.jsxs(N,{children:[e.jsx(b,{children:t}),p.map((S,h)=>e.jsx(b,{children:e.jsx(E,{control:e.jsx(_,{name:t,value:h.toString(),checked:r[t]===h.toString(),onChange:T=>a({target:{name:t,value:T.target.value}})})})},h))]},f))]})]})})]})}case"HTMLTEXT":return e.jsx(y,{children:J(o)});case"dairyFoodsTable":{const{foods:s,timeRangesFood:n,title:p}=o,i=()=>{s.forEach(t=>{a({target:{name:t,value:"2"}})})};return e.jsxs(y,{children:[e.jsx(O,{variant:"contained",onClick:i,sx:{mb:2},children:"Check All"}),e.jsx(se,{component:Z,children:e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(N,{children:[e.jsx(b,{children:p}),n.map((t,f)=>e.jsx(b,{children:t},f))]})}),e.jsx(re,{className:"radio-table",children:s.map((t,f)=>e.jsxs(N,{children:[e.jsx(b,{children:t}),n.map((S,h)=>e.jsx(b,{children:e.jsx(E,{control:e.jsx(_,{name:t,value:h.toString(),checked:r[t]===h.toString(),onChange:T=>a({target:{name:t,value:T.target.value}})})})},h))]},f))})]})})]})}case"FoodsTableTwo":{const{foodsTwo:s=[],TwotimeRangesFood:n=[],titleTwo:p=""}=o||{},i=()=>{s.forEach(t=>{a({target:{name:`${t[0]}_${t[1]}`,value:"2"}})})};return e.jsxs(y,{children:[e.jsx(O,{variant:"contained",onClick:i,sx:{mb:2},children:"Check All"}),e.jsx(se,{component:Z,children:e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(N,{children:[e.jsx(b,{children:p}),e.jsx(b,{}),n.map((t,f)=>e.jsx(b,{children:t},f))]})}),e.jsx(re,{className:"radio-table-two",children:s.map((t,f)=>e.jsxs(N,{children:[e.jsx(b,{children:t[0]}),e.jsx(b,{children:t[1]}),n.map((S,h)=>e.jsx(b,{children:e.jsx(E,{control:e.jsx(_,{name:`${t[0]}_${t[1]}`,value:h.toString(),checked:r[`${t[0]}_${t[1]}`]===h.toString(),onChange:T=>a({target:{name:`${t[0]}_${t[1]}`,value:T.target.value}})})})},h))]},f))})]})})]})}case"radioButtonWithData":{const[s,...n]=o,p=r[s]||"";return e.jsxs(R,{component:"fieldset",children:[e.jsx(L,{component:"legend",children:s}),e.jsx(G,{name:s,onChange:a,value:p,children:n.map((i,t)=>{const[f,...S]=i;return e.jsxs(y,{children:[e.jsx(E,{value:f,control:e.jsx(_,{sx:K}),label:f}),p===f&&S.length>0&&e.jsx(y,{sx:{pl:4},children:S.map((h,T)=>{const[W,Q]=Object.entries(h)[0];return e.jsx(y,{sx:{mt:2},children:ge(W,Q,a,r)},T)})})]},t)})})]})}case"button":{const[s,n]=o;return e.jsx(O,{variant:"contained",href:n,sx:{my:2,width:"fit-content",padding:"8px 16px"},target:"_blank",children:s})}case"radioFemale":if((V(s=>{var n,p,i;return(i=(p=(n=s.questionnaire)==null?void 0:n.data)==null?void 0:p["general-information"])==null?void 0:i["What is your sex assigned at birth?"]})||"")==="1"){const[s,...n]=o;return e.jsxs(R,{component:"fieldset",children:[e.jsx(L,{component:"legend",children:s}),e.jsx(G,{name:s,onChange:a,value:r[s]||"",children:n.map((p,i)=>e.jsx(E,{value:i.toString(),control:e.jsx(_,{sx:K}),label:p},i))})]})}else return null;case"RecuresiveQuestion":{const{inpute:s,recursiveContent:n,title:p}=o,i=parseInt(r[s.key]||"0",10),t=f=>{const{name:S,value:h}=f.target;parseInt(h,10)<=s.max&&a(f)};return e.jsxs(y,{children:[e.jsxs(R,{children:[e.jsx(L,{children:s.label}),e.jsx(ue,{type:"number",variant:"outlined",sx:{bgcolor:"white"},name:s.key,value:i,onChange:t,inputProps:{min:0,max:s.max}}),i>0&&e.jsx(I,{variant:"p",sx:{mt:1,color:"gray",fontSize:"14px"},children:"Which family members have been diagnosed with Crohnâ€™s disease, ulcerative colitis, or IBD-unclassified? (Select all that apply.)"})]}),Array.from({length:i}).map((f,S)=>e.jsx(y,{sx:{mt:4,p:2,border:"1px solid #ccc",borderRadius:"8px"},children:n.map((h,T)=>e.jsx(y,{sx:{mt:2},children:e.jsxs(R,{component:"fieldset",children:[e.jsxs(L,{component:"legend",children:[h.label.replace("index",`${S+1}`)," ",S+1]}),e.jsx(G,{name:`${s.key}_${S}_${h.label}`,value:r[`${s.key}_${S}_${h.label}`]||"",onChange:a,children:h.options.map((W,Q)=>e.jsx(E,{value:Q.toString(),control:e.jsx(_,{sx:K}),label:W},Q))})]})},T))},S))]})}default:return e.jsx(I,{variant:"body1",children:o})}},Qe=({section:F,log:o,handleChange:a,formData:r})=>e.jsx(y,{component:"section",sx:{my:4,display:"flex",flexDirection:"column"},children:Object.entries(F).map(([g,m],v)=>e.jsx(we.Fragment,{children:ge(g,m,a,r)},v))}),He=({data:F,log:o,type:a})=>{const[r,g]=w.useState({}),m=he(),v=me(),c=V(x=>x.questionnaire.currentSectionIndex),u=V(x=>x.questionnaire.sectionTags),B=V(x=>x.questionnaire.data[u[c]]||{}),q=V(x=>x.questionnaire.data),[$,s]=w.useState(!1),{createForm:n,response:p,loading:i,error:t}=_e(),{FinishForm:f,response:S,loading:h,error:T}=Oe();w.useEffect(()=>{Object.keys(B).length>0&&g(B)},[c,B]),w.useEffect(()=>{console.log("error:",t),t&&(t===500||t===403)&&m("/login")},[t]);const W=x=>{const{name:C,value:P,type:X,checked:M}=x.target;g(z=>{if(X==="checkbox"){const D=z[C]||[];return M?{...z,[C]:[...D,P]}:{...z,[C]:D.filter(Y=>Y!==P)}}else return{...z,[C]:P}})},Q=()=>{var ie,ce;const x=document.getElementById("form"),C=x.querySelectorAll("input, select, textarea"),P=new Set,X=new Set;let M=!0;C.forEach(l=>{l.classList.remove("error-field");const j=l.closest("fieldset"),d=j==null?void 0:j.querySelector("legend");d&&d.classList.remove("error-field")});for(const l of C){const j=l.closest("fieldset"),d=l.name||l.id||"Unnamed Field";if(l.type==="checkbox")if(l.checked)X.add(l.name);else{const k=j==null?void 0:j.querySelector("legend");k&&k.classList.add("error-field")}else if(l.type==="radio")l.checked&&P.add(l.name);else if(l.type==="text"){if(!l.value.trim()){console.log(`Text field "${d}" is empty!`),l.classList.add("error-field");const A=l.closest(".MuiFormControl-root"),H=A==null?void 0:A.querySelector("legend");H&&H.textContent.includes("How old are you?")&&H.classList.add("error-field"),console.log("false 1 "),M=!1}}else if(!l.value.trim()){console.log(`Field "${d}" is empty!`),l.classList.add("error-field");const A=j==null?void 0:j.querySelector("legend");A&&A.classList.add("error-field"),console.log("false 2 "),M=!1}}const z=x.querySelectorAll('input[type="radio"]'),D=new Set(Array.from(z).map(l=>l.name));for(const l of D)if(!P.has(l)){const d=(ie=x.querySelectorAll(`input[name="${l}"]`)[0])==null?void 0:ie.closest("fieldset"),k=d==null?void 0:d.querySelector("legend");k&&k.classList.add("error-field"),console.log("groupElements:",d),console.log("false 3 ");const A=d==null?void 0:d.classList.contains("not-required");if(console.log("isFieldsetNotRequired",A),A)continue;M=!1}const Y=x.querySelectorAll('input[type="checkbox"]'),ke=new Set(Array.from(Y).map(l=>l.name));for(const l of ke)if(!X.has(l)){const d=(ce=x.querySelectorAll(`input[name="${l}"]`)[0])==null?void 0:ce.closest("fieldset"),k=d==null?void 0:d.querySelector("legend");k&&k.classList.add("error-field"),console.log("false 4 "),M=!1}const ae=document.querySelector(".radio-table");ae&&ae.querySelectorAll("tr").forEach(j=>{const d=j.querySelector("td");d&&d.classList.remove("error-field");const k=j.querySelectorAll('input[type="radio"]');!Array.from(k).some(H=>H.checked)&&d&&d.classList.add("error-field")});const le=document.querySelector(".radio-table-two");return le&&le.querySelectorAll("tr").forEach(j=>{const d=j.querySelectorAll("td")[1];d&&d.classList.remove("error-field");const k=j.querySelectorAll('input[type="radio"]');!Array.from(k).some(H=>H.checked)&&d&&(d.classList.add("error-field"),console.log("false 5 "),M=!1)}),M},je=async()=>{v(qe({data:$e})),location.reload()},ye=async()=>{s(!0);try{const x={...q,[u[c]]:r},C=await n(x);if(C!=null&&C.success)v(ee({currentSectionIndex:c,data:r})),U.success("Form has been saved Questionnaire!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});else throw new Error("Failed to save form data")}catch{U.error("Error saving the Questionnaire. Please try again!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}finally{s(!1)}},be=()=>{if(!Q()){U.error("Please fill out all fields.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});return}v(ee({currentSectionIndex:c,data:r}));const x={...q,[u[c]]:r};n(x),c<u.length-1&&(v(de(c+1)),g({}),m(`/${u[c+1]}`))},ve=()=>{if(!Q()){U.error("Please fill out all fields.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});return}const x={...q,[u[c]]:r};f(x),v(ee({currentSectionIndex:c,data:r})),m("/knowledge-and-attitudes-survey")},Se=()=>{if(c>0){v(de(c-1));const x={...q,[u[c]]:r};n(x),m(`/${u[c-1]}`)}};return e.jsxs(pe,{children:[e.jsx(Fe,{}),e.jsxs("form",{id:"form",children:[F.map((x,C)=>e.jsx(Qe,{section:x,log:o,handleChange:W,formData:r},C)),a==="fixe"?e.jsx(O,{variant:"contained",onClick:()=>m("/disease-information"),children:"Continue to Crohnâ€™s disease information"}):e.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[e.jsx(O,{variant:"contained",onClick:Se,disabled:c===0,children:"Back"}),e.jsx(O,{variant:"contained",color:"primary",onClick:ye,startIcon:$?e.jsx(Te,{size:20}):e.jsx(fe,{}),disabled:$,children:$?"Saving...":"Save"}),c<u.length-1?e.jsx(e.Fragment,{children:e.jsx(O,{variant:"contained",onClick:be,children:"Next"})}):e.jsx(O,{variant:"contained",onClick:ve,children:"Finish"})]}),a==="fixe"?"":e.jsx(y,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(O,{variant:"contained",onClick:je,children:"Fill"})})]})]})},Ue=({title:F,Data:o,type:a})=>{const r=he();me();const g=V($=>$.questionnaire.currentSectionIndex),m=V($=>$.questionnaire.sectionTags),{sectionTag:v}=Ae(),{loading:c,error:u,success:B,userRole:q}=Ee();return w.useEffect(()=>{console.log("state:",q.state),q.state==="1"&&q.role!=="1"&&r("/profile?role="+q.role)},[B]),w.useEffect(()=>{const $=m[g];v!==$&&a!=="fixe"&&r(`/${$}`)},[v,g,m,r]),e.jsxs(e.Fragment,{children:[F?e.jsx("div",{className:"title-content",children:e.jsx("h1",{children:F})}):"",e.jsx(pe,{className:"my-4 qstn-body",children:e.jsx("div",{className:"",children:e.jsx(He,{data:o,log:!0,type:a})})})]})};export{Ue as default};
